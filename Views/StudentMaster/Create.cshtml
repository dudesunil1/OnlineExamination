@model OnlineExamination.Models.StudentMasterModel

@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm("Create", "StudentMaster", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()
    <div class="dashboard-body">

        <!-- Breadcrumb -->
        <div class="breadcrumb-with-buttons mb-24 flex-between flex-wrap gap-8">
            <div class="breadcrumb mb-24">
                <ul class="flex-align gap-4">
                    <li><a href="index.html" class="text-gray-200 fw-normal text-15 hover-text-main-600">Home</a></li>
                    <li><span class="text-gray-500 fw-normal d-flex"><i class="ph ph-caret-right"></i></span></li>
                    <li><span class="text-main-600 fw-normal text-15">Create Student</span></li>
                </ul>
            </div>
        </div>

        <!-- Student Form -->
        <div class="card shadow-lg border-0">
            <div class="card-header border-bottom border-gray-100 flex-align gap-8">
                <h5 class="mb-0">@ViewBag.Title</h5>
            </div>
            <div class="card-body">

                <div class="row gy-20">
                    <!-- Name Field -->
                    <div class="col-sm-6">
                        <label for="Stud_Name" class="h5 mb-8 fw-semibold font-heading">
                           Student Name
                            <span class="text-13 text-gray-400 fw-medium">(Required)</span>
                        </label>
                        <div class="position-relative">
                            @Html.TextBoxFor(model => model.Stud_Name, new { @class = "form-control py-11" })
                            @Html.ValidationMessageFor(model => model.Stud_Name, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Mobile Field -->
                    <div class="col-sm-6">
                        <label for="Stud_Mobile" class="h5 mb-8 fw-semibold font-heading">
                           Mobile No
                            <span class="text-13 text-gray-400 fw-medium">(Required)</span>
                        </label>
                        <div class="position-relative">
                            @Html.TextBoxFor(model => model.Stud_Mobile, new { type = "number", @class = "form-control py-11" })
                            @Html.ValidationMessageFor(model => model.Stud_Mobile, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Date of Birth Field -->
                    <div class="col-sm-6">
                        <label for="Stud_DOB" class="h5 mb-8 fw-semibold font-heading">
                          DOB
                        </label>
                        <div class="position-relative">
                            @Html.TextBoxFor(model => model.Stud_DOB, "{0:yyyy-MM-dd}", new { @type = "date", @class = "form-control py-11" })
                            @Html.ValidationMessageFor(model => model.Stud_DOB, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Gender Field -->
                    <div class="col-sm-6">
                        <label for="Stud_Gender" class="h5 mb-8 fw-semibold font-heading">
                            Gender
                        </label>
                        <div class="position-relative">
                            @Html.DropDownListFor(model => model.Stud_Gender, new SelectList(new[] { "Male", "Female", "Other" }), "- Select Gender -", new { @class = "form-select py-9" })
                            @Html.ValidationMessageFor(model => model.Stud_Gender, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Photo Field -->
                    <div class="col-sm-6">
                        <label for="Stud_Photo" class="h5 mb-8 fw-semibold font-heading">
                           Photo
                        </label>
                        <div class="position-relative">
                            <input type="file" class="form-control" id="imageUpload" name="Stud_Photo" accept="image/*">
                            @Html.ValidationMessageFor(model => model.Stud_Photo, "", new { @class = "text-danger" })
                        </div>
                        <div class="mb-3">
                            <label for="imagePreview" class="form-label">Image Preview</label>
                            <img id="imagePreview" src="#" alt="Image Preview" style="display:none; width: 150px; height: 150px; object-fit: cover;">
                        </div>
                    </div>

                    <!-- Username Field -->
                    <div class="col-sm-6">
                        <label for="Stud_UserName" class="h5 mb-8 fw-semibold font-heading">
                            User Name
                        </label>
                        <div class="position-relative">
                            @Html.TextBoxFor(model => model.Stud_UserName, new { @class = "form-control py-11" })
                            @Html.ValidationMessageFor(model => model.Stud_UserName, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Password Field -->
                    <div class="col-sm-6">
                        <label for="Stud_Password" class="h5 mb-8 fw-semibold font-heading">
                            Password
                            <span class="text-13 text-gray-400 fw-medium">(Required)</span>
                        </label>
                        <div class="position-relative">
                            @Html.TextBoxFor(model => model.Stud_Password, new { type = "password", @class = "form-control py-11" })
                            @Html.ValidationMessageFor(model => model.Stud_Password, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Admission Date Field -->
                    <div class="col-sm-6">
                        <label for="Stud_AdmissionDate" class="h5 mb-8 fw-semibold font-heading">
                            Admission Date
                        </label>
                        <div class="position-relative">
                            @Html.TextBoxFor(model => model.Stud_AdmissionDate, "{0:yyyy-MM-dd}", new { @type = "date", @class = "form-control py-11" })
                            @Html.ValidationMessageFor(model => model.Stud_AdmissionDate, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Group Field -->
                    <div class="col-sm-6">
                        <label for="Stud_Group" class="h5 mb-8 fw-semibold font-heading">
                           Group
                            <span class="text-13 text-gray-400 fw-medium">(Required)</span>
                        </label>
                        <div class="position-relative">
                            @Html.DropDownListFor(model => model.Stud_Group, new SelectList(ViewBag.GroupList, "Value", "Text"), "Select Group", new { @class = "form-select py-9" })
                            @Html.ValidationMessageFor(model => model.Stud_Group, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Class Field -->
                    <div class="col-sm-6">
                        <label for="Stud_Class" class="h5 mb-8 fw-semibold font-heading">
                           Class
                        </label>
                        <div class="position-relative">
                            @if (ViewBag.Classlist != null)
                            {
                                @Html.DropDownListFor(model => model.Stud_Class, new SelectList(ViewBag.Classlist, "Value", "Text"), "Select Class", new { @class = "form-select py-9" })
                            }
                            else
                            {
                                <p>No classes available.</p>
                            }
                            @Html.ValidationMessageFor(model => model.Stud_Class, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="flex-align justify-content-end gap-8 mt-4">
                        <input type="submit" name="Action" value="Back To List" class="btn btn-outline-main rounded-pill py-9" />
                        <input type="submit" name="Action" value="Cancel" class="btn btn-outline-main rounded-pill py-9" />
                        <input type="submit" name="Action" value="Create" class="btn btn-main rounded-pill py-9" />
                    </div>
                </div>
            </div>
        </div>
    </div>

    @section Scripts {
        <partial name="_ValidationScriptsPartial" />
    }

    <script>
        // Set today's date as the default value in the Stud_AdmissionDate input field
        window.onload = function () {
            const today = new Date().toISOString().split('T')[0]; // yyyy-MM-dd format
            document.getElementById('Stud_AdmissionDate').value = today;
        };

        // Display image preview when the file is selected
        document.getElementById('imageUpload').addEventListener('change', function (event) {
            const file = event.target.files[0]; // Get the selected file
            if (file) {
                const reader = new FileReader();

                // Event listener for when the file is read
                reader.onload = function (e) {
                    const preview = document.getElementById('imagePreview');
                    preview.src = e.target.result; // Set the image source to the file data URL
                    preview.style.display = 'block'; // Show the image preview
                };

                reader.readAsDataURL(file); // Read the file as a Data URL
            }
        });
    </script>
}
